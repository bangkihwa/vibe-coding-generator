<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë°”ì´ë¸Œ ì½”ë”© í”„ë¡¬í”„íŠ¸ ìƒì„±ê¸° | AI ì•± ê°œë°œ ìë™í™”</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #7c3aed;
            --primary-dark: #6d28d9;
            --primary-light: #a78bfa;
            --secondary: #0ea5e9;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --gray: #6b7280;
            --light: #f3f4f6;
            --white: #ffffff;
            --shadow-sm: 0 1px 2px 0 rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px -5px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 40px -10px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--shadow-xl);
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .input-section h2, .chat-section h2 {
            color: var(--dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .icon {
            width: 24px;
            height: 24px;
        }

        .idea-input {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .idea-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .chat-container {
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            background: var(--light);
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .message {
            margin-bottom: 15px;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .message.user {
            text-align: right;
        }

        .message.ai {
            text-align: left;
        }

        .message-content {
            display: inline-block;
            padding: 12px 16px;
            border-radius: 12px;
            max-width: 80%;
        }

        .message.user .message-content {
            background: var(--primary);
            color: white;
        }

        .message.ai .message-content {
            background: white;
            color: var(--dark);
            box-shadow: var(--shadow-sm);
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
        }

        .progress-section {
            margin-top: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 40px;
            background: var(--light);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 20px;
            transition: width 0.5s ease-out;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .questions-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .question-badge {
            padding: 8px 12px;
            background: var(--light);
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
            transition: all 0.3s;
        }

        .question-badge.completed {
            background: var(--success);
            color: white;
        }

        .results-section {
            display: none;
            grid-column: span 2;
        }

        .results-section.active {
            display: block;
        }

        .document-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--light);
        }

        .tab {
            padding: 12px 20px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: var(--gray);
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .document-content {
            background: var(--light);
            padding: 20px;
            border-radius: 12px;
            max-height: 600px;
            overflow-y: auto;
        }

        .document-content pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            line-height: 1.6;
        }

        .actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid var(--light);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .status-message {
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            display: none;
        }

        .status-message.success {
            background: #d1fae5;
            color: #065f46;
            display: block;
        }

        .status-message.error {
            background: #fee2e2;
            color: #991b1b;
            display: block;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2rem;
            }

            .questions-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .tips {
            background: linear-gradient(135deg, #fef3c7, #fed7aa);
            border-left: 4px solid var(--warning);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .tips h3 {
            color: #92400e;
            margin-bottom: 10px;
        }

        .tips ul {
            color: #78350f;
            margin-left: 20px;
        }

        .tips li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ ë°”ì´ë¸Œ ì½”ë”© í”„ë¡¬í”„íŠ¸ ìƒì„±ê¸°</h1>
            <p>AIì™€ í•¨ê»˜ ì•„ì´ë””ì–´ë¥¼ í˜„ì‹¤ë¡œ ë§Œë“œëŠ” ê°€ì¥ ë¹ ë¥¸ ë°©ë²•</p>
        </div>

        <div class="main-content">
            <!-- ì•„ì´ë””ì–´ ì…ë ¥ ì„¹ì…˜ -->
            <div class="card input-section">
                <h2>
                    <svg class="icon" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"></path>
                    </svg>
                    ì•„ì´ë””ì–´ ì…ë ¥
                </h2>
                <textarea class="idea-input" placeholder="ì–´ë–¤ ì•±ì„ ë§Œë“¤ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?
ì˜ˆì‹œ:
- 'ì´ë©”ì¼ ë‹µì¥ì„ ìë™ìœ¼ë¡œ ì‘ì„±í•´ì£¼ëŠ” ì•±ì„ ë§Œë“¤ê³  ì‹¶ì–´'
- 'ìš´ë™ ë£¨í‹´ì„ ê´€ë¦¬í•˜ê³  ì¶”ì²œí•´ì£¼ëŠ” ì•±ì´ í•„ìš”í•´'
- 'ì¼ì • ê´€ë¦¬ì™€ ë©”ëª¨ë¥¼ í•œ ë²ˆì— í•  ìˆ˜ ìˆëŠ” ì•±ì„ êµ¬ìƒì¤‘ì´ì•¼'"></textarea>

                <div class="actions">
                    <button class="btn btn-primary" onclick="analyzeIdea()">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M5 3a5 5 0 0 0 0 10h6a5 5 0 0 0 0-10H5zm6 9a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/>
                        </svg>
                        AI ë¶„ì„ ì‹œì‘
                    </button>
                    <button class="btn btn-secondary" onclick="loadExample()">
                        ì˜ˆì‹œ ë¶ˆëŸ¬ì˜¤ê¸°
                    </button>
                </div>

                <div class="tips">
                    <h3>ğŸ’¡ íŒ</h3>
                    <ul>
                        <li>êµ¬ì²´ì ì¸ ë¬¸ì œë‚˜ ë¶ˆí¸í•¨ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”</li>
                        <li>ì£¼ìš” ì‚¬ìš©ìê°€ ëˆ„êµ¬ì¸ì§€ ìƒê°í•´ë³´ì„¸ìš”</li>
                        <li>í•µì‹¬ ê¸°ëŠ¥ 2-3ê°œë¥¼ ë¨¼ì € ì •ì˜í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤</li>
                    </ul>
                </div>
            </div>

            <!-- AI ëŒ€í™” ì„¹ì…˜ -->
            <div class="card chat-section">
                <h2>
                    <svg class="icon" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"></path>
                        <path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"></path>
                    </svg>
                    AIì™€ ëŒ€í™”í•˜ê¸°
                </h2>

                <div class="chat-container" id="chatContainer">
                    <div class="message ai">
                        <div class="message-content">
                            ì•ˆë…•í•˜ì„¸ìš”! ì•„ì´ë””ì–´ë¥¼ êµ¬ì²´í™”í•˜ëŠ” ê²ƒì„ ë„ì™€ë“œë¦´ê²Œìš”. ë¨¼ì € ì™¼ìª½ì— ì•„ì´ë””ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.
                        </div>
                    </div>
                </div>

                <div class="chat-input-container">
                    <button class="btn btn-secondary" onclick="skipQuestion()" id="skipBtn" style="display:none;">ê±´ë„ˆë›°ê¸°</button>
                    <input type="text" class="chat-input" id="chatInput" placeholder="ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”..." disabled>
                    <button class="btn btn-primary" onclick="sendAnswer()" id="sendBtn" disabled>ì „ì†¡</button>
                </div>

                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>AIê°€ ìƒê°í•˜ëŠ” ì¤‘...</p>
                </div>

                <div class="status-message" id="statusMessage"></div>
            </div>
        </div>

        <!-- ì§„í–‰ ìƒí™© -->
        <div class="card progress-section">
            <h2>ì§„í–‰ ìƒí™©</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%;">
                    0%
                </div>
            </div>
            <div class="questions-grid" id="questionsGrid">
                <!-- 16ê°œ ì§ˆë¬¸ ë°°ì§€ê°€ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>

        <!-- ê²°ê³¼ ì„¹ì…˜ -->
        <div class="card results-section" id="resultsSection">
            <h2>ğŸ‰ ìƒì„±ëœ ë¬¸ì„œ</h2>

            <div class="document-tabs">
                <button class="tab active" onclick="switchTab('prd')">PRD</button>
                <button class="tab" onclick="switchTab('trd')">TRD</button>
                <button class="tab" onclick="switchTab('userflow')">User Flow</button>
                <button class="tab" onclick="switchTab('prompt')">Prompt Design</button>
                <button class="tab" onclick="switchTab('oneshot')">ì›ìƒ· í”„ë¡¬í”„íŠ¸</button>
            </div>

            <div class="document-content" id="documentContent">
                <pre id="documentText">ë¬¸ì„œê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</pre>
            </div>

            <div class="actions">
                <button class="btn btn-primary" onclick="copyDocument()">
                    ğŸ“‹ ë³µì‚¬í•˜ê¸°
                </button>
                <button class="btn btn-secondary" onclick="downloadDocument()">
                    ğŸ’¾ ë‹¤ìš´ë¡œë“œ
                </button>
                <button class="btn btn-success" onclick="generateNextDocument()">
                    ë‹¤ìŒ ë¬¸ì„œ ìƒì„±
                </button>
            </div>
        </div>
    </div>

    <script>
        // Gemini API ì„¤ì •
        const GEMINI_API_KEY = 'AIzaSyBXwz6MIv-Td4-50z_XPW4uBL81HzZMkhY';
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent';

        // 16ê°œ ì§ˆë¬¸ í…œí”Œë¦¿
        const questions = [
            "í”„ë¡œì íŠ¸ì˜ ì´ë¦„ì„ ì•Œë ¤ì£¼ì„¸ìš”.",
            "ì´ í”„ë¡œì íŠ¸ì˜ ì„±ê²©ì„ ê°€ì¥ ì˜ ì„¤ëª…í•˜ëŠ” ë²”ì£¼ëŠ” ë¬´ì—‡ì¸ê°€ìš”?",
            "í”„ë¡œì íŠ¸ì˜ ë¹„ì „ì´ë‚˜ ëª©í‘œë¥¼ ììœ ë¡­ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”.",
            "ì£¼ ì‚¬ìš©ìëŠ” ëˆ„êµ¬ì¸ê°€ìš”?",
            "ì‚¬ìš©ìê°€ ê²ªê³  ìˆëŠ” ë¬¸ì œë‚˜ ë¶ˆí¸í•¨ì„ ê°„ë‹¨íˆ ì ì–´ì£¼ì„¸ìš”.",
            "ê¼­ í•„ìš”í•˜ë‹¤ê³  ìƒê°í•˜ëŠ” ê¸°ëŠ¥ì„ ì„ íƒí•´ì£¼ì„¸ìš”.",
            "ì´ ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©ìê°€ ê°€ì¥ ë¨¼ì € í•˜ê²Œ ë  í–‰ë™ì„ ì„œìˆ í•´ì£¼ì„¸ìš”.",
            "í™”ë©´ ë¶„ìœ„ê¸°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš” (ì‹¬í”Œ/í™”ë ¤í•œ/ë¹„ì¦ˆë‹ˆìŠ¤/ì¬ë¯¸ìˆëŠ”)",
            "ì›í•˜ëŠ” UI/UX ì•„ì´ë””ì–´ë‚˜ ì°¸ê³ í•˜ê³  ì‹¶ì€ ì„œë¹„ìŠ¤ê°€ ìˆë‹¤ë©´ ì ì–´ì£¼ì„¸ìš”.",
            "ì–´ë–¤ í™˜ê²½ì—ì„œ ì‚¬ìš©ë  ì˜ˆì •ì¸ê°€ìš”? (ì›¹/ëª¨ë°”ì¼/ë°ìŠ¤í¬í†±)",
            "ì‚¬ìš©í•˜ê³  ì‹¶ì€ ê¸°ìˆ  ìŠ¤íƒì´ë‚˜ í™˜ê²½ì´ ìˆë‹¤ë©´ ì ì–´ì£¼ì„¸ìš”.",
            "ë°ì´í„° ì €ì¥ ë°©ì‹ì„ ì„ íƒí•´ì£¼ì„¸ìš” (ë¡œì»¬/í´ë¼ìš°ë“œ/í˜¼í•©)",
            "ë°˜ë“œì‹œ ì—°ë™í•˜ê³  ì‹¶ì€ ì™¸ë¶€ ì„œë¹„ìŠ¤(API)ê°€ ìˆë‹¤ë©´ ì ì–´ì£¼ì„¸ìš”.",
            "í”„ë¡œì íŠ¸ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê°€ì¹˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”?",
            "í…ŒìŠ¤íŠ¸/í’ˆì§ˆì— ëŒ€í•œ ìƒê°ì„ ì ì–´ì£¼ì„¸ìš”.",
            "í”„ë¡œì íŠ¸ì—ì„œ ìì£¼ ì“¸ ë‹¨ì–´ë‚˜ ì•½ì–´ë¥¼ ì ì–´ì£¼ì„¸ìš”."
        ];

        let currentQuestionIndex = 0;
        let projectData = {};
        let conversationHistory = [];
        let generatedDocuments = {};

        // ì´ˆê¸°í™”
        function init() {
            renderQuestionBadges();
        }

        // ì§ˆë¬¸ ë°°ì§€ ë Œë”ë§
        function renderQuestionBadges() {
            const grid = document.getElementById('questionsGrid');
            grid.innerHTML = questions.map((q, i) => `
                <div class="question-badge" id="q${i}">Q${i + 1}</div>
            `).join('');
        }

        // ì˜ˆì‹œ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadExample() {
            document.querySelector('.idea-input').value = `ì´ë©”ì¼ì´ë‚˜ ë©”ì‹œì§€ì— ë‹µì¥í•˜ëŠ” ê²ƒì´ ë¶€ë‹´ìŠ¤ëŸ¬ì›Œìš”.
íŠ¹íˆ ê±°ì ˆí•´ì•¼ í•˜ëŠ” ìƒí™©ì—ì„œ ì–´ë–»ê²Œ ì •ì¤‘í•˜ê²Œ í‘œí˜„í•´ì•¼ í• ì§€ ë§¤ë²ˆ ê³ ë¯¼ë©ë‹ˆë‹¤.
ìë™ìœ¼ë¡œ ìƒí™©ì— ë§ëŠ” ì •ì¤‘í•œ ë‹µì¥ì„ ìƒì„±í•´ì£¼ëŠ” ì•±ì´ ìˆìœ¼ë©´ ì¢‹ê² ì–´ìš”.`;
        }

        // AIë¡œ ì•„ì´ë””ì–´ ë¶„ì„
        async function analyzeIdea() {
            const ideaText = document.querySelector('.idea-input').value.trim();
            if (!ideaText) {
                showStatus('ì•„ì´ë””ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!', 'error');
                return;
            }

            // ì•„ì´ë””ì–´ ì €ì¥
            projectData.initial_idea = ideaText;
            currentQuestionIndex = 0;

            // UI í™œì„±í™”
            document.getElementById('chatInput').disabled = false;
            document.getElementById('sendBtn').disabled = false;
            document.getElementById('skipBtn').style.display = 'inline-block';

            // ì²« ë²ˆì§¸ ì§ˆë¬¸ ì‹œì‘
            addMessage(`ì¢‹ì€ ì•„ì´ë””ì–´ë„¤ìš”! "${ideaText}" ë¥¼ ë” êµ¬ì²´í™”í•´ë³´ê² ìŠµë‹ˆë‹¤. ëª‡ ê°€ì§€ ì§ˆë¬¸ì„ ë“œë¦´ê²Œìš”.`, 'ai');

            setTimeout(() => {
                askNextQuestion();
            }, 1000);
        }

        // Gemini API í˜¸ì¶œ
        async function callGeminiAPI(prompt, isSystemMessage = false) {
            showLoading(true);

            try {
                const response = await fetch(GEMINI_API_URL + '?key=' + GEMINI_API_KEY, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 8192
                        }
                    })
                });

                const data = await response.json();

                if (data.candidates && data.candidates[0]) {
                    const aiResponse = data.candidates[0].content.parts[0].text;

                    if (isSystemMessage) {
                        addMessage(aiResponse, 'ai');

                        // ì§ˆë¬¸ ë²ˆí˜¸ ì¶”ì¶œ
                        const questionMatch = aiResponse.match(/\[Q(\d+)\]/);
                        if (questionMatch) {
                            currentQuestionIndex = parseInt(questionMatch[1]) - 1;
                            updateProgress();
                        }
                    }

                    showLoading(false);
                    return aiResponse;
                }
            } catch (error) {
                console.error('API Error:', error);
                showStatus('AI ì‘ë‹µ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                showLoading(false);
            }
        }

        // ë‹¤ìŒ ì§ˆë¬¸í•˜ê¸°
        function askNextQuestion() {
            if (currentQuestionIndex < questions.length) {
                const question = questions[currentQuestionIndex];
                let formattedQuestion = question;

                // ì§ˆë¬¸ì„ ë” ì¹œê·¼í•˜ê²Œ í¬ë§·íŒ…
                if (currentQuestionIndex === 0) {
                    formattedQuestion = "ë¨¼ì €, í”„ë¡œì íŠ¸ì˜ ì´ë¦„ì„ ì •í•´ë³¼ê¹Œìš”? ì–´ë–¤ ì´ë¦„ì´ ì¢‹ì„ê¹Œìš”?";
                } else if (currentQuestionIndex === 1) {
                    formattedQuestion = "ì´ í”„ë¡œì íŠ¸ëŠ” ì–´ë–¤ ì¢…ë¥˜ì˜ ì•±ì¸ê°€ìš”? (ì˜ˆ: ìƒì‚°ì„± ë„êµ¬, ì†Œì…œ, ê²Œì„, êµìœ¡ ë“±)";
                } else if (currentQuestionIndex === 3) {
                    formattedQuestion = "ì£¼ë¡œ ëˆ„ê°€ ì‚¬ìš©í•  ê²ƒ ê°™ë‚˜ìš”? (ì˜ˆ: í•™ìƒ, ì§ì¥ì¸, ì£¼ë¶€, ì „ë¬¸ê°€ ë“±)";
                } else if (currentQuestionIndex === 7) {
                    formattedQuestion = "í™”ë©´ ë””ìì¸ì€ ì–´ë–¤ ëŠë‚Œì´ë©´ ì¢‹ì„ê¹Œìš”? (ì‹¬í”Œí•œ/í™”ë ¤í•œ/ë¹„ì¦ˆë‹ˆìŠ¤/ì¬ë¯¸ìˆëŠ”)";
                } else if (currentQuestionIndex === 9) {
                    formattedQuestion = "ì–´ë””ì„œ ì‚¬ìš©í•  ì˜ˆì •ì¸ê°€ìš”? (ì›¹/ëª¨ë°”ì¼ ì•±/ë°ìŠ¤í¬í†± í”„ë¡œê·¸ë¨)";
                }

                addMessage(`[ì§ˆë¬¸ ${currentQuestionIndex + 1}/16] ${formattedQuestion}`, 'ai');

                // ì„ íƒì§€ê°€ ìˆëŠ” ì§ˆë¬¸ë“¤ì— ë²„íŠ¼ ì¶”ê°€
                if (currentQuestionIndex === 7) {
                    addQuickResponses(['ì‹¬í”Œí•˜ê³  ê¹”ë”í•œ', 'í™”ë ¤í•˜ê³  ë‹¤ì±„ë¡œìš´', 'ë¹„ì¦ˆë‹ˆìŠ¤ ì „ë¬¸ì ì¸', 'ì¬ë¯¸ìˆê³  ê·€ì—¬ìš´']);
                } else if (currentQuestionIndex === 9) {
                    addQuickResponses(['ëª¨ë°”ì¼ ì•±', 'ì›¹ì‚¬ì´íŠ¸', 'ë°ìŠ¤í¬í†± í”„ë¡œê·¸ë¨', 'ëª¨ë“  í”Œë«í¼']);
                } else if (currentQuestionIndex === 11) {
                    addQuickResponses(['ë¡œì»¬ ì €ì¥ë§Œ', 'í´ë¼ìš°ë“œ ì €ì¥', 'ë‘˜ ë‹¤ ì‚¬ìš©']);
                }
            } else {
                // ëª¨ë“  ì§ˆë¬¸ ì™„ë£Œ
                addMessage("ëª¨ë“  ì •ë³´ê°€ ìˆ˜ì§‘ë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ AIê°€ ì™„ë²½í•œ ê°œë°œ ë¬¸ì„œì™€ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.", 'ai');
                generateDocuments();
            }
        }

        // ë¹ ë¥¸ ì‘ë‹µ ë²„íŠ¼ ì¶”ê°€
        function addQuickResponses(options) {
            const container = document.getElementById('chatContainer');
            const buttonsDiv = document.createElement('div');
            buttonsDiv.className = 'quick-responses';
            buttonsDiv.style.cssText = 'display: flex; gap: 10px; margin: 10px 0; flex-wrap: wrap;';

            options.forEach(option => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-secondary';
                btn.textContent = option;
                btn.style.cssText = 'padding: 8px 16px; font-size: 14px;';
                btn.onclick = () => {
                    document.getElementById('chatInput').value = option;
                    buttonsDiv.remove();
                    sendAnswer();
                };
                buttonsDiv.appendChild(btn);
            });

            container.appendChild(buttonsDiv);
            container.scrollTop = container.scrollHeight;
        }

        // ë‹µë³€ ì „ì†¡
        async function sendAnswer() {
            const input = document.getElementById('chatInput');
            const answer = input.value.trim();

            if (!answer) return;

            // ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
            addMessage(answer, 'user');

            // ë‹µë³€ ì €ì¥
            projectData[`q${currentQuestionIndex + 1}_${questions[currentQuestionIndex].split(' ')[0]}`] = answer;

            // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
            document.getElementById(`q${currentQuestionIndex}`).classList.add('completed');

            // ì…ë ¥ ì´ˆê¸°í™”
            input.value = '';

            // ë‹¤ìŒ ì§ˆë¬¸ìœ¼ë¡œ ì´ë™
            currentQuestionIndex++;
            updateProgress();

            // ì ì‹œ í›„ ë‹¤ìŒ ì§ˆë¬¸
            setTimeout(() => {
                askNextQuestion();
            }, 500);
        }

        // ë©”ì‹œì§€ ì¶”ê°€
        function addMessage(text, sender) {
            const container = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.innerHTML = `<div class="message-content">${text}</div>`;
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
        }

        // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
        function updateProgress() {
            const completed = currentQuestionIndex;
            const total = 16; // ì „ì²´ ì§ˆë¬¸ 16ê°œ
            const percentage = Math.round((completed / total) * 100);

            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = `${percentage}%`;
            progressBar.textContent = `${percentage}% (${completed}/16)`;
        }

        // ë¬¸ì„œ ìƒì„±
        async function generateDocuments() {
            document.getElementById('resultsSection').classList.add('active');

            showStatus('ë¬¸ì„œ ìƒì„±ì„ ì‹œì‘í•©ë‹ˆë‹¤...', 'success');

            // ìˆ˜ì§‘ëœ ì „ì²´ ë‹µë³€ ì •ë¦¬
            const formattedAnswers = questions.map((q, i) => {
                const key = `q${i + 1}_${q.split(' ')[0]}`;
                return `${i + 1}. ${q}\n   ë‹µë³€: ${projectData[key] || '(ê±´ë„ˆëœ€)'}`;
            }).join('\n\n');

            // PRD ìƒì„±
            const prdPrompt = `ë‹¤ìŒì€ ì‚¬ìš©ìê°€ 16ê°œ ì§ˆë¬¸ì— ë‹µë³€í•œ ë‚´ìš©ì…ë‹ˆë‹¤:

${formattedAnswers}

ì´ˆê¸° ì•„ì´ë””ì–´: ${projectData.initial_idea}

ìœ„ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìƒì„¸í•œ PRD(Product Requirements Document)ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”:

PRD êµ¬ì¡°:
1. ì œí’ˆ ê°œìš”
2. ëª©í‘œ ë° ë¹„ì „
3. íƒ€ê²Ÿ ì‚¬ìš©ì
4. í•µì‹¬ ê¸°ëŠ¥
5. ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤
6. ì„±ê³µ ì§€í‘œ

ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;

            const prd = await callGeminiAPI(prdPrompt);
            generatedDocuments.prd = prd;

            // TRD ìƒì„±
            const trdPrompt = `ë‹¤ìŒ PRDë¥¼ ë°”íƒ•ìœ¼ë¡œ TRD(Technical Requirements Document)ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”:

${prd}

TRD êµ¬ì¡°:
1. ê¸°ìˆ  ìŠ¤íƒ
2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
3. API ì„¤ê³„
4. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„
5. ë³´ì•ˆ ìš”êµ¬ì‚¬í•­
6. ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­

ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;

            const trd = await callGeminiAPI(trdPrompt);
            generatedDocuments.trd = trd;

            // User Flow ìƒì„±
            const userflowPrompt = `ë‹¤ìŒ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ User Flowë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”:

${Object.entries(projectData).map(([key, value]) => `- ${key}: ${value}`).join('\n')}

User Flow êµ¬ì¡°:
1. ì£¼ìš” ì‚¬ìš©ì í”Œë¡œìš° ì •ì˜
2. ê° í”Œë¡œìš°ì˜ ë‹¨ê³„ë³„ ì„¤ëª…
3. Mermaid ë‹¤ì´ì–´ê·¸ë¨ ì½”ë“œ

ë§ˆí¬ë‹¤ìš´ê³¼ Mermaid í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;

            const userflow = await callGeminiAPI(userflowPrompt);
            generatedDocuments.userflow = userflow;

            // Prompt Design ìƒì„±
            const promptDesignPrompt = `ë‹¤ìŒ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ AI ê°œë°œì„ ìœ„í•œ Prompt Design ë¬¸ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”:

${Object.entries(projectData).map(([key, value]) => `- ${key}: ${value}`).join('\n')}

Prompt Design êµ¬ì¡°:
1. ê°œë°œ ë§ˆì¼ìŠ¤í†¤ (5ë‹¨ê³„)
2. ê° ë§ˆì¼ìŠ¤í†¤ë³„ êµ¬ì²´ì ì¸ í”„ë¡¬í”„íŠ¸
3. í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

ê° í”„ë¡¬í”„íŠ¸ëŠ” AIê°€ ë°”ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;

            const promptDesign = await callGeminiAPI(promptDesignPrompt);
            generatedDocuments.prompt = promptDesign;

            // ì›ìƒ· í”„ë¡¬í”„íŠ¸ ìƒì„±
            generatedDocuments.oneshot = generateOneShotPrompt();

            // ì²« ë²ˆì§¸ ë¬¸ì„œ í‘œì‹œ
            switchTab('prd');

            showStatus('ëª¨ë“  ë¬¸ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        }

        // ì§ˆë¬¸ ê±´ë„ˆë›°ê¸°
        function skipQuestion() {
            addMessage("(ì´ ì§ˆë¬¸ì€ ê±´ë„ˆë›°ì—ˆìŠµë‹ˆë‹¤)", 'user');

            // ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸
            document.getElementById(`q${currentQuestionIndex}`).style.background = '#fef3c7';

            // ë‹¤ìŒ ì§ˆë¬¸ìœ¼ë¡œ ì´ë™
            currentQuestionIndex++;
            updateProgress();

            setTimeout(() => {
                askNextQuestion();
            }, 300);
        }

        // ì›ìƒ· í”„ë¡¬í”„íŠ¸ ìƒì„±
        function generateOneShotPrompt() {
            const formattedAnswers = questions.map((q, i) => {
                const key = `q${i + 1}_${q.split(' ')[0]}`;
                return `${i + 1}. ${q}: ${projectData[key] || '(ê±´ë„ˆëœ€)'}`;
            }).join('\n');

            return `ë„ˆëŠ” **10ë…„ ì´ìƒì˜ ê²½í—˜ì„ ê°€ì§„ ì‹œë‹ˆì–´ ê°œë°œì**ì´ì ì•„í‚¤í…íŠ¸ë‹¤. ì§€ê¸ˆë¶€í„° ë‹¨ í•˜ë‚˜ì˜ ì§€ì‹œë¥¼ í†µí•´ ì™„ì „í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì¶•í•˜ëŠ” **'ììœ¨ ê°œë°œ(Autonomous Development)'** ì„¸ì…˜ì„ ì‹œì‘í•œë‹¤.

**[í”„ë¡œì íŠ¸ ì •ë³´]**
ì´ˆê¸° ì•„ì´ë””ì–´: ${projectData.initial_idea}

ì§ˆë¬¸ ë‹µë³€ ë‚´ìš©:
${formattedAnswers}

**[í•µì‹¬ ë¬¸ì„œ]**
ë‹¤ìŒ 4ê°œì˜ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì—¬ ê°œë°œì„ ì§„í–‰í•œë‹¤:
1. PRD (Product Requirements Document)
2. TRD (Technical Requirements Document)
3. User Flow
4. Prompt Design

**[ê°œë°œ ì§€ì¹¨]**
1. ë¬¸ì„œ ë¶„ì„: ë¨¼ì € ëª¨ë“  ë¬¸ì„œë¥¼ ê¹Šì´ ìˆê²Œ ë¶„ì„í•˜ê³  ì´í•´í•œë‹¤.
2. ë§ˆì¼ìŠ¤í†¤ ì‹¤í–‰: Prompt Designì— ì •ì˜ëœ 5ê°œ ë§ˆì¼ìŠ¤í†¤ì„ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•œë‹¤.
3. ììœ¨ ì§„í–‰: ê° ë§ˆì¼ìŠ¤í†¤ ì™„ë£Œ í›„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ìë™ ì§„í–‰í•œë‹¤.
4. í’ˆì§ˆ ê´€ë¦¬: ê° ë‹¨ê³„ë§ˆë‹¤ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ê³  ì˜¤ë¥˜ë¥¼ ìì²´ ìˆ˜ì •í•œë‹¤.
5. ìµœì¢… ê²€ì¦: ëª¨ë“  ë§ˆì¼ìŠ¤í†¤ ì™„ë£Œ í›„ ì „ì²´ ì‹œìŠ¤í…œì„ ê²€ì¦í•œë‹¤.

**[ì‹¤í–‰ ëª…ë ¹]**
ì§€ê¸ˆë¶€í„° ë§ˆì¼ìŠ¤í†¤ 1ë¶€í„° ì‹œì‘í•˜ì—¬ ì „ì²´ ê°œë°œì„ ììœ¨ì ìœ¼ë¡œ ì™„ë£Œí•˜ë¼.`;
        }

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // ì„ íƒëœ íƒ­ í™œì„±í™”
            event.target.classList.add('active');

            // ë¬¸ì„œ ë‚´ìš© í‘œì‹œ
            const content = generatedDocuments[tabName] || 'ë¬¸ì„œë¥¼ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...';
            document.getElementById('documentText').textContent = content;
        }

        // ë¬¸ì„œ ë³µì‚¬
        function copyDocument() {
            const activeTab = document.querySelector('.tab.active').textContent.toLowerCase().replace(' ', '');
            const content = generatedDocuments[activeTab];

            if (content) {
                navigator.clipboard.writeText(content).then(() => {
                    showStatus('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
                });
            }
        }

        // ë¬¸ì„œ ë‹¤ìš´ë¡œë“œ
        function downloadDocument() {
            const activeTab = document.querySelector('.tab.active').textContent;
            const content = generatedDocuments[activeTab.toLowerCase().replace(' ', '')];

            if (content) {
                const blob = new Blob([content], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${activeTab}.md`;
                a.click();
                URL.revokeObjectURL(url);
                showStatus('ë‹¤ìš´ë¡œë“œê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            }
        }

        // ë¡œë”© í‘œì‹œ
        function showLoading(show) {
            const loading = document.getElementById('loading');
            if (show) {
                loading.classList.add('active');
            } else {
                loading.classList.remove('active');
            }
        }

        // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ
        function showStatus(message, type) {
            const statusEl = document.getElementById('statusMessage');
            statusEl.textContent = message;
            statusEl.className = `status-message ${type}`;

            setTimeout(() => {
                statusEl.className = 'status-message';
            }, 3000);
        }

        // Enter í‚¤ë¡œ ì „ì†¡
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendAnswer();
            }
        });

        // ì´ˆê¸°í™” ì‹¤í–‰
        init();
    </script>
</body>
</html>